description: 'Build the MPICH library'
inputs:
  mpich_version:
    description: 'Tag in the MPICH repository to use'
    default: v4.0.3
    required: False
    type: string
  install_prefix:
    description: 'Install path of mpich'
    default: $HOME/mpich
    required: False
    type: string
runs:
  using: composite
  steps:
    - uses: actions/checkout@v3
      with:
        repository: open-mpi/ompi
        path: openmpi-src
        ref: ${{ inputs.openmpi_version }}
        submodules: 'recursive'
    - id: openmpi-build
      shell: bash
      run: |
        pushd openmpi-src
        perl ./autogen.pl
        ./configure --prefix=${{ inputs.install_prefix }} 
        make -j4
        make install
        popd

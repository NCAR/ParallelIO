<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PIO: Installing PIO</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PIO
   &#160;<span id="projectnumber">2.5.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Installing PIO </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md15"></a>
Getting the Release</h2>
<p>The PIO code is currently stored on github at <a href="https://github.com/PARALLELIO/ParallelIO">https://github.com/PARALLELIO/ParallelIO</a>. For questions about downloading or developing this code, consult the <a href="https://github.com/CESM-Development/cime/wiki/CIME-Git-Workflow">CIME Git Wiki</a> or email <a href="#" onclick="location.href='mai'+'lto:'+'jed'+'wa'+'rds'+'@u'+'car'+'.e'+'du'; return false;">jedwa<span style="display: none;">.nosp@m.</span>rds@<span style="display: none;">.nosp@m.</span>ucar.<span style="display: none;">.nosp@m.</span>edu</a>.</p>
<p>Download the latest release from the GitHub releases page. Download the release tarball, which will be named something like pio-2.4.3.tar.gz.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Dependencies</h2>
<p>PIO can use NetCDF (version 4.6.1+) and/or PnetCDF (version 1.9.0+) for I/O. Ideally, the NetCDF version should be built with MPI, which requires that it be linked with an MPI-enabled version of HDF5. Optionally, NetCDF can be built with DAP support, which introduces a dependency on CURL. Additionally, HDF5, itself, introduces dependencies on LIBZ and (optionally) SZIP.</p>
<div class="image">
<img src="PIO_Library_Architecture1.jpg" alt=""/>
<div class="caption">
PIO Library Architecture</div></div>
<h2><a class="anchor" id="autotoc_md17"></a>
Building PIO C and Fortran Libraries</h2>
<p>Unpack the tarball and build with:</p>
<pre>
./configure --enable-fortran
make
make check
make install
</pre><p>Environment flags CC and FC should be set to MPI C and Fortran compilers. CPPFLAGS may be set to a list of directories which have the include files for netCDF and pnetcdf. LDFLAGS may be set to a list of directories where libraries may be found.</p>
<p>A complete example:</p>
<pre>
export CPPFLAGS='-I/usr/local/pnetcdf-1.11.0_shared/include -I/usr/local/netcdf-c-4.7.0_hdf5-1.10.5_mpich-3.2/include -I/usr/local/netcdf-fortran-4.4.5_c_4.6.3_mpich-3.2/include'
export LDFLAGS='-L/usr/local/pnetcdf-1.11.0_shared/lib  -L/usr/local/netcdf-c-4.7.0_hdf5-1.10.5_mpich-3.2/lib'
export CC=mpicc
export FC=mpifort
export CFLAGS='-g -Wall'
./configure --enable-fortran
make check
make install
</pre><p>#</p>
<h2><a class="anchor" id="autotoc_md18"></a>
Testing with MPI</h2>
<p>The tests are run as a bash script with called mpiexec to launch programs. If this will not work for the install system, use the &ndash;disable-test-runs option to configure. This will cause the tests to be built, but not run. The tests may be run them manually.</p>
<h3><a class="anchor" id="autotoc_md19"></a>
Optional GPTL Use</h3>
<p>PIO may optionally be built with the General Purpose Timing Library (GPTL). This is necessary for the performance testing program pioperf, but optional for the rest of the library and tests. To build with GPTL, include a path to its include and lib directories in the CPPFLAGS/LDFLAGS flags before running configure.</p>
<h3><a class="anchor" id="autotoc_md20"></a>
PIO Library Logging</h3>
<p>If built with &ndash;enable-logging, the PIO libraries will output logging statements to files (one per task) and stdout. Use the <a class="el" href="pioc__support_8c.html#a1bb546dedd6290cb450577658e955edb" title="Set the logging level if PIO was built with PIO_ENABLE_LOGGING.">PIOc_set_log_level()</a> function to turn on logging. This will have a negative impact on performance, when used, but helps with debugging.</p>
<h2><a class="anchor" id="autotoc_md21"></a>
Building with CMake</h2>
<p>A CMake build system is also avaible for the PIO C and Fortran libraries. User may prefer to use a CMake build instead of the autotools build.</p>
<ul>
<li><a class="el" href="mach_walkthrough.html">CMake Install Walk-through</a></li>
</ul>
<p>To configure the build, PIO requires CMake version 2.8.12+. The typical configuration with CMake can be done as follows: </p><pre class="fragment">&gt; CC=mpicc FC=mpif90 cmake [-DOPTION1=value1 -DOPTION2=value2 ...] /path/to/pio/source
</pre><p>where <code>mpicc</code> and <code>mpif90</code> are the appropriate MPI-enabled compiler wrappers for your system.</p>
<p>The <code>OPTIONS</code> section typically should consist of pointers to the install locations for various dependencies, assuming these dependencies are not located in <em>canonical</em> search locations. <br  />
</p>
<p>For each dependency <code>XXX</code>, one can specify the location of its installation path with the CMake variable <code>XXX_PATH</code>. If the <code>C</code> and <code>Fortran</code> libraries for the dependency are installed in different locations (such as can be done with NetCDF), then you can specify individually <code>XXX_C_PATH</code> and <code>XXX_Fortran_PATH</code>. Hence, you can specify the locations of both NetCDF-C and NetCDF-Fortran, as well as PnetCDF, with the following CMake configuration line:</p>
<pre class="fragment">&gt; CC=mpicc FC=mpif90 cmake -DNetCDF_C_PATH=/path/to/netcdf-c \
           -DNetCDF_Fortran_PATH=/path/to/netcdf-fortran \
           -DPnetCDF_PATH=/path/to/pnetcdf \
           /path/to/pio/source
</pre><p>This works for the dependencies: <code>NetCDF</code>, <code>PnetCDF</code>, <code>HDF5</code>, <code>LIBZ</code>, <code>SZIP</code>.</p>
<p>For specific instructions to install on various commonly used super computers, please read the <a class="el" href="mach_walkthrough.html">walk-through guide to PIO Installation</a>.</p>
<h3><a class="anchor" id="autotoc_md22"></a>
Additional CMake Options</h3>
<p>Additional configuration options can be specified on the command line.</p>
<p>The <code>PIO_ENABLE_TIMING</code> option can be set to <code>ON</code> or <code>OFF</code> to enable or disable the use of GPTL timing in the PIO libraries. This feature requires the GPTL C library for the PIO <code>C</code> library and the GPTL Fortran library with the <code>perf_mod.mod</code> and <code>perf_utils.mod</code> interface modules. If these GPTL libraries are already installed on the system, the user can point PIO to the location of these libraries with the <code>GPTL_PATH</code> variable (or, individually, <code>GPTL_C_PATH</code> and <code>GPTL_Fortran_Perf_PATH</code> variables). However, if these GPTL libraries are not installed on the system, and GPTL cannot be found, then PIO will build its own internal version of GPTL. <br  />
</p>
<p>If PnetCDF is not installed on the system, the user can disable its use by setting <code>-DWITH_PNETCDF=OFF</code>. This will disable the search for PnetCDF on the system and disable the use of PnetCDF from within PIO.</p>
<p>If the user wishes to disable the PIO tests, then the user can set the variable <code>-DPIO_ENABLE_TESTS=OFF</code>. This will entirely disable the CTest testing suite, as well as remove all of the test build targets.</p>
<p>If you wish to install PIO in a safe location for use later with other software, you may set the <code>CMAKE_INSTALL_PREFIX</code> variable to point to the desired install location.</p>
<h3><a class="anchor" id="autotoc_md23"></a>
Building with CMake</h3>
<p>Once you have successfully configured PIO with CMake in a build directory. From within the build directory, build PIO with:</p>
<pre class="fragment">&gt; make
</pre><p>This will build the <code>pioc</code> and <code>piof</code> libraries.</p>
<h3><a class="anchor" id="autotoc_md24"></a>
Testing with CMake</h3>
<p>If you desire to do testing, and <code>PIO_ENABLE_TESTS=ON</code> (which is the default setting), you may build the test executables with:</p>
<pre class="fragment">&gt; make tests
</pre><p>Once the tests have been built, you may run tests with:</p>
<pre class="fragment">&gt; ctest
</pre><p><em>Note: If you have not run <code>make tests</code> before you run <code>ctest</code>, then you will see all of the tests fail.</em></p>
<p>Alternatively, you may build the test executables and then run tests immediately with:</p>
<pre class="fragment">&gt; make check
</pre><p>(similar to the typical <code>make check</code> Autotools target).</p>
<p>ANOTHER NOTE:* These tests are designed to run in parallel. If you are on one of the supported supercomputing platforms (i.e., NERSC, NWSC, ALCF, etc.), then the <code>ctest</code> command will assume that the tests will be run in an appropriately configured and scheduled parallel job. This can be done by requesting an interactive session from the login nodes and then running <code>ctest</code> from within the interactive terminal. Alternatively, this can be done by running the <code>ctest</code> command from a job submission script. It is important to understand, however, that <code>ctest</code> itself will preface all of the test executable commands with the appropriate <code>mpirun</code>/<code>mpiexec</code>/<code>runjob</code>/etc. Hence, you should not further preface the <code>ctest</code> command with these MPI launchers.</p>
<ul>
<li><a class="el" href="test.html">Cmake Testing Information</a></li>
</ul>
<h3><a class="anchor" id="autotoc_md25"></a>
Installing with CMake</h3>
<p>Once you have built the PIO libraries, you may install them in the location specified by the <code>CMAKE_INSTALL_PREFIX</code>. To do this, simply type:</p>
<pre class="fragment">&gt; make install
</pre><p>If the internal GPTL libraries were built (because GPTL could not be found and the <code>PIO_ENABLE_TIMING</code> variable is set to <code>ON</code>), then these libraries will be installed with PIO.</p>
<h3><a class="anchor" id="autotoc_md26"></a>
CMake Build Examples</h3>
<p>From within the build directory, build the PIO examples with:</p>
<pre class="fragment">&gt; make examples
</pre><p>This will build the C and Fortran examples in under the examples subdirectory. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 2 2021 10:44:51 for PIO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
